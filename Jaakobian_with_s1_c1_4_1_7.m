syms t1 t2 t3 t4 t5 t6 FX FY FZ MX MY MZ M
syms s1 s2 s3 s4 s5 s6 c1 c2 c3 c4 c5 c6
L1=123;
L2=258;
L3=0;
L4=264;
L5=0;
L6=159;

T01=[c1,0,s1,0;s1,0,-c1,0;0,1,0,L1;0,0,0,1];
T12=[c2,-s2,0,L2*c2;s2,c2,0,L2*s2;0,0,1,0;0,0,0,1];
T23=[c3,0,-s3,0;s3,0,c3,0;0,-1,0,L3;0,0,0,1];
T34=[c4,0,-s4,0;s4,0,c4,0;0,-1,0,L4;0,0,0,1];
T45=[c5,0,s5,0;s5,0,-c5,0;0,1,0,L5;0,0,0,1];
T56=[c6,-s6,0,0;s6,c6,0,0;0,0,1,L6;0,0,0,1];

V=[0,0,1]';

T02=T01*T12;
T03=T02*T23;
T04=T03*T34;
T05=T04*T45;
T06=T05*T56;

b0=[0 0 1]';
b1=T01(1:3,1:3)*V;
b2=T02(1:3,1:3)*V;
b3=T03(1:3,1:3)*V;
b4=T04(1:3,1:3)*V;
b5=T05(1:3,1:3)*V;
b6=T06(1:3,1:3)*V;

P00=[0 0 0 1]';
r0=T06(:,4)-P00;
r1=T06(:,4)-T01(:,4);
r2=T06(:,4)-T02(:,4);
r3=T06(:,4)-T03(:,4);
r4=T06(:,4)-T04(:,4);
r5=T06(:,4)-T05(:,4);

JL1=cross(b0',r0(1:3)')';
JL2=cross(b1',r1(1:3)')';
JL3=cross(b2',r2(1:3)')';
JL4=cross(b3',r3(1:3)')';
JL5=cross(b4',r4(1:3)')';
JL6=cross(b5',r5(1:3)')';

JA1=b0;
JA2=b1;
JA3=b2;
JA4=b3;
JA5=b4;
JA6=b5;

J00=[JL1 JL2 JL3 JL4 JL5 JL6;JA1 JA2 JA3 JA4 JA5 JA6];

R06=T06(1:3,1:3);
Transfer06=[(R06).' ,zeros(3,3); zeros(3,3) (R06).'];
J6=Transfer06*J00.';

r_x=T06(1,4);
r_y=T06(2,4);

FX=0;
FY=0;
FZ=-9.81*M;
MX=r_y*FZ;
MY=-r_x*FZ;
MZ=0;

F=[FX FY FZ].';
T=[MX MY MZ].';
Force_and_moments=[F;T];

tau=(J6.')*Force_and_moments;

